<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Slack InApp Browser Debug</title>
  <style>
    * { box-sizing: border-box; }
    body {
      font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
      padding: 16px;
      background: #1a1d21;
      color: #e8e8e8;
      font-size: 14px;
      line-height: 1.5;
    }
    h1 { font-size: 18px; color: #fff; margin-bottom: 16px; }
    h2 { font-size: 14px; color: #36c5f0; margin: 16px 0 8px; }
    .section {
      background: #222529;
      border-radius: 8px;
      padding: 12px;
      margin-bottom: 12px;
      overflow-x: auto;
    }
    .label { color: #9e9e9e; font-size: 12px; }
    .value { color: #fff; word-break: break-all; }
    pre {
      margin: 0;
      white-space: pre-wrap;
      word-break: break-all;
      font-size: 12px;
      color: #e8e8e8;
    }
    .highlight { color: #2eb67d; }
    .warn { color: #ecb22e; }
    button {
      background: #36c5f0;
      color: #000;
      border: none;
      padding: 10px 16px;
      border-radius: 6px;
      font-size: 14px;
      margin: 4px;
      cursor: pointer;
    }
    button:active { opacity: 0.8; }
    #customProps { max-height: 400px; overflow-y: auto; }
  </style>
</head>
<body>
  <h1>ğŸ” Slack InApp Browser Debug</h1>

  <h2>User Agent</h2>
  <div class="section">
    <pre id="userAgent"></pre>
  </div>

  <h2>ê¸°ë³¸ í™˜ê²½</h2>
  <div class="section">
    <div><span class="label">Platform:</span> <span class="value" id="platform"></span></div>
    <div><span class="label">Screen:</span> <span class="value" id="screen"></span></div>
    <div><span class="label">Viewport:</span> <span class="value" id="viewport"></span></div>
    <div><span class="label">DevicePixelRatio:</span> <span class="value" id="dpr"></span></div>
    <div><span class="label">Touch:</span> <span class="value" id="touch"></span></div>
    <div><span class="label">Online:</span> <span class="value" id="online"></span></div>
  </div>

  <h2>Slack / ì•± ê´€ë ¨ ê°ì²´</h2>
  <div class="section">
    <pre id="slackObjects"></pre>
  </div>

  <h2>Window ì»¤ìŠ¤í…€ ì†ì„±</h2>
  <div class="section">
    <p class="label">ê¸°ë³¸ ë¸Œë¼ìš°ì €ì— ì—†ëŠ” window ì†ì„±ë“¤:</p>
    <pre id="customProps"></pre>
  </div>

  <h2>WebView ë¸Œë¦¿ì§€ ì²´í¬</h2>
  <div class="section">
    <pre id="bridges"></pre>
  </div>

  <h2>Window ê°ì²´ ì „ì²´ íƒìƒ‰</h2>
  <div class="section">
    <div style="margin-bottom:8px;">
      <button onclick="exploreAllWindow()">ì „ì²´ ìŠ¤ìº”</button>
      <button onclick="exploreObject(window, 'window')">window íƒìƒ‰</button>
      <button onclick="exploreObject(window.navigator, 'navigator')">navigator íƒìƒ‰</button>
      <button onclick="exploreObject(window.screen, 'screen')">screen íƒìƒ‰</button>
      <button onclick="exploreObject(window.location, 'location')">location íƒìƒ‰</button>
      <button onclick="clearExplorer()">ì´ˆê¸°í™”</button>
    </div>
    <div style="margin-bottom:8px;">
      <input type="text" id="searchKey" placeholder="ì†ì„±ëª… ê²€ìƒ‰ (ì˜ˆ: slack, bridge)" 
        style="width:60%; padding:8px; background:#1a1d21; color:#fff; border:1px solid #444; border-radius:4px;">
      <button onclick="searchWindow()">ê²€ìƒ‰</button>
    </div>
    <div id="explorer" style="max-height:500px; overflow-y:auto;"></div>
  </div>

  <h2>ê°ì²´ ìƒì„¸ ë³´ê¸°</h2>
  <div class="section">
    <input type="text" id="objectPath" placeholder="ê²½ë¡œ ì…ë ¥ (ì˜ˆ: window.navigator.userAgent)" 
      style="width:70%; padding:8px; background:#1a1d21; color:#fff; border:1px solid #444; border-radius:4px;">
    <button onclick="inspectPath()">ì¡°íšŒ</button>
    <pre id="inspectResult" style="margin-top:8px; max-height:400px; overflow-y:auto;"></pre>
  </div>

  <h2>ì»¤ìŠ¤í…€ ì½”ë“œ ì‹¤í–‰</h2>
  <div class="section">
    <textarea id="customCode" rows="4" style="width:100%; background:#1a1d21; color:#fff; border:1px solid #444; border-radius:4px; padding:8px; font-family:monospace; font-size:12px;">JSON.stringify(window.navigator, null, 2)</textarea>
    <br>
    <button onclick="runCustomCode()">ì‹¤í–‰</button>
    <button onclick="copyResults()">ê²°ê³¼ ë³µì‚¬</button>
    <button onclick="copyAllResults()">ì „ì²´ ê²°ê³¼ ë³µì‚¬</button>
    <pre id="customResult" style="margin-top:8px; color:#2eb67d;"></pre>
  </div>

  <script>
    // User Agent
    document.getElementById('userAgent').textContent = navigator.userAgent;

    // ê¸°ë³¸ í™˜ê²½
    document.getElementById('platform').textContent = navigator.platform;
    document.getElementById('screen').textContent = `${screen.width} x ${screen.height}`;
    document.getElementById('viewport').textContent = `${window.innerWidth} x ${window.innerHeight}`;
    document.getElementById('dpr').textContent = window.devicePixelRatio;
    document.getElementById('touch').textContent = 'ontouchstart' in window ? 'Yes' : 'No';
    document.getElementById('online').textContent = navigator.onLine ? 'Yes' : 'No';

    // Slack ê´€ë ¨ ê°ì²´ ì²´í¬
    const slackChecks = [
      'slack', 'Slack', 'SLACK',
      'slackDebug', 'SlackWebView',
      'TSSSB', 'TS', 
      'desktop', 'electronAPI',
      'webkit.messageHandlers',
      'ReactNativeWebView',
      'slackMobile', 'SlackMobile'
    ];

    let slackResult = '';
    slackChecks.forEach(key => {
      let value;
      try {
        value = eval('window.' + key);
        const exists = value !== undefined;
        slackResult += `${exists ? 'âœ…' : 'âŒ'} ${key}: ${exists ? typeof value : 'undefined'}\n`;
        if (exists && typeof value === 'object') {
          try {
            const keys = Object.keys(value).slice(0, 10);
            if (keys.length > 0) {
              slackResult += `   â””â”€ keys: ${keys.join(', ')}${Object.keys(value).length > 10 ? '...' : ''}\n`;
            }
          } catch(e) {}
        }
      } catch(e) {
        slackResult += `âŒ ${key}: error\n`;
      }
    });
    document.getElementById('slackObjects').textContent = slackResult;

    // ê¸°ë³¸ window ì†ì„± ëª©ë¡ (ë¹„êµìš©)
    const defaultWindowProps = new Set([
      'Object', 'Function', 'Array', 'Number', 'parseFloat', 'parseInt', 'Infinity', 'NaN', 'undefined',
      'Boolean', 'String', 'Symbol', 'Date', 'Promise', 'RegExp', 'Error', 'AggregateError', 'EvalError',
      'RangeError', 'ReferenceError', 'SyntaxError', 'TypeError', 'URIError', 'globalThis', 'JSON', 'Math',
      'Intl', 'ArrayBuffer', 'Uint8Array', 'Int8Array', 'Uint16Array', 'Int16Array', 'Uint32Array',
      'Int32Array', 'Float32Array', 'Float64Array', 'Uint8ClampedArray', 'BigUint64Array', 'BigInt64Array',
      'DataView', 'Map', 'BigInt', 'Set', 'WeakMap', 'WeakSet', 'Proxy', 'Reflect', 'FinalizationRegistry',
      'WeakRef', 'decodeURI', 'decodeURIComponent', 'encodeURI', 'encodeURIComponent', 'escape', 'unescape',
      'eval', 'isFinite', 'isNaN', 'console', 'Option', 'Image', 'Audio', 'webkitURL', 'webkitRTCPeerConnection',
      'webkitMediaStream', 'WebKitMutationObserver', 'WebKitCSSMatrix', 'XPathResult', 'XPathExpression',
      'XPathEvaluator', 'XMLSerializer', 'XMLHttpRequestUpload', 'XMLHttpRequestEventTarget', 'XMLHttpRequest',
      'XMLDocument', 'WritableStreamDefaultWriter', 'WritableStreamDefaultController', 'WritableStream',
      'Worker', 'Window', 'WheelEvent', 'WebSocket', 'WebGLVertexArrayObject', 'WebGLUniformLocation',
      'WebGLTransformFeedback', 'WebGLTexture', 'WebGLSync', 'WebGLShaderPrecisionFormat', 'WebGLShader',
      'WebGLSampler', 'WebGLRenderingContext', 'WebGL2RenderingContext', 'WebGLQuery', 'WebGLProgram',
      'WebGLFramebuffer', 'WebGLContextEvent', 'WebGLBuffer', 'WebGLActiveInfo', 'WaveShaperNode',
      'VisualViewport', 'ValidityState', 'VTTCue', 'UserActivation', 'URLSearchParams', 'URL', 'UIEvent',
      'TreeWalker', 'TransitionEvent', 'TransformStream', 'TrackEvent', 'TouchList', 'TouchEvent', 'Touch',
      'TimeRanges', 'TextTrackList', 'TextTrackCueList', 'TextTrackCue', 'TextTrack', 'TextMetrics',
      'TextEvent', 'TextEncoderStream', 'TextEncoder', 'TextDecoderStream', 'TextDecoder', 'Text',
      'TaskAttributionTiming', 'SyncManager', 'SubmitEvent', 'StyleSheetList', 'StyleSheet',
      'StylePropertyMapReadOnly', 'StylePropertyMap', 'StorageEvent', 'Storage', 'StereoPannerNode',
      'StaticRange', 'SourceBufferList', 'SourceBuffer', 'ShadowRoot', 'Selection', 'SecurityPolicyViolationEvent',
      'ScriptProcessorNode', 'ScreenOrientation', 'Screen', 'SVGViewElement', 'SVGUseElement', 'SVGUnitTypes',
      'document', 'location', 'navigator', 'history', 'screen', 'innerWidth', 'innerHeight', 'scrollX',
      'scrollY', 'pageXOffset', 'pageYOffset', 'visualViewport', 'screenX', 'screenY', 'outerWidth',
      'outerHeight', 'devicePixelRatio', 'clientInformation', 'screenLeft', 'screenTop', 'defaultStatus',
      'defaultstatus', 'styleMedia', 'onsearch', 'isSecureContext', 'performance', 'onappinstalled',
      'onbeforeinstallprompt', 'crypto', 'indexedDB', 'sessionStorage', 'localStorage', 'onbeforexrselect',
      'onabort', 'onblur', 'oncancel', 'oncanplay', 'oncanplaythrough', 'onchange', 'onclick', 'onclose',
      'oncontextmenu', 'oncuechange', 'ondblclick', 'ondrag', 'ondragend', 'ondragenter', 'ondragleave',
      'ondragover', 'ondragstart', 'ondrop', 'ondurationchange', 'onemptied', 'onended', 'onerror', 'onfocus',
      'onformdata', 'oninput', 'oninvalid', 'onkeydown', 'onkeypress', 'onkeyup', 'onload', 'onloadeddata',
      'onloadedmetadata', 'onloadstart', 'onmousedown', 'onmouseenter', 'onmouseleave', 'onmousemove',
      'onmouseout', 'onmouseover', 'onmouseup', 'onmousewheel', 'onpause', 'onplay', 'onplaying',
      'onprogress', 'onratechange', 'onreset', 'onresize', 'onscroll', 'onseeked', 'onseeking', 'onselect',
      'onstalled', 'onsubmit', 'onsuspend', 'ontimeupdate', 'ontoggle', 'onvolumechange', 'onwaiting',
      'onwebkitanimationend', 'onwebkitanimationiteration', 'onwebkitanimationstart', 'onwebkittransitionend',
      'onwheel', 'onauxclick', 'ongotpointercapture', 'onlostpointercapture', 'onpointerdown', 'onpointermove',
      'onpointerup', 'onpointercancel', 'onpointerover', 'onpointerout', 'onpointerenter', 'onpointerleave',
      'onselectstart', 'onselectionchange', 'onanimationend', 'onanimationiteration', 'onanimationstart',
      'ontransitionrun', 'ontransitionstart', 'ontransitionend', 'ontransitioncancel', 'onafterprint',
      'onbeforeprint', 'onbeforeunload', 'onhashchange', 'onlanguagechange', 'onmessage', 'onmessageerror',
      'onoffline', 'ononline', 'onpagehide', 'onpageshow', 'onpopstate', 'onrejectionhandled', 'onstorage',
      'onunhandledrejection', 'onunload', 'alert', 'atob', 'blur', 'btoa', 'cancelAnimationFrame',
      'cancelIdleCallback', 'captureEvents', 'clearInterval', 'clearTimeout', 'close', 'confirm',
      'createImageBitmap', 'fetch', 'find', 'focus', 'getComputedStyle', 'getSelection', 'matchMedia',
      'moveBy', 'moveTo', 'open', 'postMessage', 'print', 'prompt', 'queueMicrotask', 'releaseEvents',
      'reportError', 'requestAnimationFrame', 'requestIdleCallback', 'resizeBy', 'resizeTo', 'scroll',
      'scrollBy', 'scrollTo', 'setInterval', 'setTimeout', 'stop', 'structuredClone', 'webkitCancelAnimationFrame',
      'webkitRequestAnimationFrame', 'chrome', 'caches', 'cookieStore', 'ondevicemotion', 'ondeviceorientation',
      'ondeviceorientationabsolute', 'launchQueue', 'AbortController', 'AbortSignal', 'AbstractRange',
      'Atomics', 'Blob', 'BlobEvent', 'ByteLengthQueuingStrategy', 'CSS', 'CSSAnimation', 'PerformanceEntry',
      'PerformanceObserver', 'self', 'window', 'frames', 'parent', 'top', 'length', 'opener', 'name', 'closed',
      'origin', 'crossOriginIsolated', 'locationbar', 'menubar', 'personalbar', 'scrollbars', 'statusbar',
      'toolbar', 'status', 'frameElement', 'external', 'trustedTypes', 'speechSynthesis', 'oncontentvisibilityautostatechange',
      'onscrollend', 'onpointerrawupdate', 'oncontextlost', 'oncontextrestored', 'SharedArrayBuffer', 'Iterator'
    ]);

    // ì»¤ìŠ¤í…€ ì†ì„± ì°¾ê¸°
    let customProps = [];
    for (let key in window) {
      if (!defaultWindowProps.has(key)) {
        try {
          const value = window[key];
          const type = typeof value;
          customProps.push({ key, type, value });
        } catch(e) {
          customProps.push({ key, type: 'error', value: e.message });
        }
      }
    }

    let customPropsText = customProps.length === 0 
      ? '(ì»¤ìŠ¤í…€ ì†ì„± ì—†ìŒ)' 
      : customProps.map(p => {
          let display = `${p.key}: ${p.type}`;
          if (p.type === 'function') {
            display += ' [function]';
          } else if (p.type === 'object' && p.value) {
            try {
              const keys = Object.keys(p.value).slice(0, 5);
              if (keys.length > 0) display += ` { ${keys.join(', ')}${Object.keys(p.value).length > 5 ? '...' : ''} }`;
            } catch(e) {}
          } else if (p.type === 'string' || p.type === 'number' || p.type === 'boolean') {
            display += ` = ${JSON.stringify(p.value).slice(0, 100)}`;
          }
          return display;
        }).join('\n');

    document.getElementById('customProps').textContent = customPropsText;

    // ë¸Œë¦¿ì§€ ì²´í¬
    let bridgeResult = '';
    const bridges = {
      'webkit.messageHandlers': () => window.webkit?.messageHandlers,
      'AndroidBridge': () => window.AndroidBridge,
      'ReactNativeWebView': () => window.ReactNativeWebView,
      'postMessage native': () => window.postMessage.toString().includes('native'),
    };

    for (const [name, check] of Object.entries(bridges)) {
      try {
        const result = check();
        const exists = result !== undefined && result !== false;
        bridgeResult += `${exists ? 'âœ…' : 'âŒ'} ${name}`;
        if (exists && typeof result === 'object') {
          try {
            bridgeResult += `: ${Object.keys(result).join(', ')}`;
          } catch(e) {}
        }
        bridgeResult += '\n';
      } catch(e) {
        bridgeResult += `âŒ ${name}: error\n`;
      }
    }
    document.getElementById('bridges').textContent = bridgeResult;

    // Window ì „ì²´ íƒìƒ‰
    let allWindowData = {};

    function safeStringify(obj, depth = 0, maxDepth = 2, seen = new WeakSet()) {
      if (depth > maxDepth) return '[max depth]';
      if (obj === null) return 'null';
      if (obj === undefined) return 'undefined';
      
      const type = typeof obj;
      
      if (type === 'function') {
        return `[function ${obj.name || 'anonymous'}]`;
      }
      if (type !== 'object') {
        return JSON.stringify(obj);
      }
      if (obj instanceof Element) {
        return `[Element: ${obj.tagName}]`;
      }
      if (obj instanceof Window) {
        return '[Window]';
      }
      if (seen.has(obj)) {
        return '[Circular]';
      }
      
      try {
        seen.add(obj);
        
        if (Array.isArray(obj)) {
          if (obj.length > 10) {
            return `[Array(${obj.length})]`;
          }
          return '[' + obj.slice(0, 10).map(v => safeStringify(v, depth + 1, maxDepth, seen)).join(', ') + ']';
        }
        
        const keys = Object.keys(obj);
        if (keys.length === 0) return '{}';
        if (keys.length > 20) {
          return `{${keys.slice(0, 20).join(', ')}... (${keys.length} keys)}`;
        }
        
        const entries = keys.slice(0, 20).map(k => {
          try {
            return `${k}: ${safeStringify(obj[k], depth + 1, maxDepth, seen)}`;
          } catch(e) {
            return `${k}: [error]`;
          }
        });
        return '{ ' + entries.join(', ') + ' }';
      } catch(e) {
        return '[error: ' + e.message + ']';
      }
    }

    function exploreAllWindow() {
      const explorer = document.getElementById('explorer');
      explorer.innerHTML = '<div style="color:#ecb22e;">ìŠ¤ìº” ì¤‘...</div>';
      
      setTimeout(() => {
        let result = [];
        allWindowData = {};
        
        for (let key in window) {
          try {
            const value = window[key];
            const type = typeof value;
            let preview = '';
            
            try {
              preview = safeStringify(value, 0, 1);
              if (preview.length > 200) preview = preview.slice(0, 200) + '...';
            } catch(e) {
              preview = '[cannot stringify]';
            }
            
            allWindowData[key] = { type, preview };
            result.push({ key, type, preview });
          } catch(e) {
            allWindowData[key] = { type: 'error', preview: e.message };
            result.push({ key, type: 'error', preview: e.message });
          }
        }
        
        result.sort((a, b) => a.key.localeCompare(b.key));
        
        let html = `<div class="label" style="margin-bottom:8px;">ì´ ${result.length}ê°œ ì†ì„±</div>`;
        html += '<div style="font-family:monospace; font-size:12px;">';
        
        result.forEach(item => {
          const color = item.type === 'function' ? '#36c5f0' : 
                       item.type === 'object' ? '#2eb67d' : 
                       item.type === 'error' ? '#e01e5a' : '#e8e8e8';
          html += `<div style="padding:2px 0; border-bottom:1px solid #333;" onclick="exploreObject(window['${item.key}'], 'window.${item.key}')" style="cursor:pointer;">`;
          html += `<span style="color:${color}; cursor:pointer;">${item.key}</span>`;
          html += ` <span style="color:#666;">(${item.type})</span>`;
          html += `<div style="color:#888; font-size:11px; margin-left:12px; white-space:nowrap; overflow:hidden; text-overflow:ellipsis;">${escapeHtml(item.preview)}</div>`;
          html += '</div>';
        });
        
        html += '</div>';
        explorer.innerHTML = html;
      }, 100);
    }

    function escapeHtml(str) {
      return String(str).replace(/&/g, '&amp;').replace(/</g, '&lt;').replace(/>/g, '&gt;');
    }

    function exploreObject(obj, path) {
      const explorer = document.getElementById('explorer');
      
      if (obj === null || obj === undefined) {
        explorer.innerHTML = `<div>${path} = ${obj}</div>`;
        return;
      }
      
      let result = [];
      
      try {
        const keys = Object.getOwnPropertyNames(obj);
        keys.forEach(key => {
          try {
            const value = obj[key];
            const type = typeof value;
            let preview = safeStringify(value, 0, 1);
            if (preview.length > 150) preview = preview.slice(0, 150) + '...';
            result.push({ key, type, preview });
          } catch(e) {
            result.push({ key, type: 'error', preview: e.message });
          }
        });
      } catch(e) {
        explorer.innerHTML = `<div style="color:#e01e5a;">íƒìƒ‰ ì‹¤íŒ¨: ${e.message}</div>`;
        return;
      }
      
      result.sort((a, b) => a.key.localeCompare(b.key));
      
      let html = `<div class="label" style="margin-bottom:8px;">${path} (${result.length}ê°œ ì†ì„±)</div>`;
      html += '<div style="font-family:monospace; font-size:12px;">';
      
      result.forEach(item => {
        const color = item.type === 'function' ? '#36c5f0' : 
                     item.type === 'object' ? '#2eb67d' : 
                     item.type === 'error' ? '#e01e5a' : '#e8e8e8';
        html += `<div style="padding:2px 0; border-bottom:1px solid #333;">`;
        html += `<span style="color:${color};">${item.key}</span>`;
        html += ` <span style="color:#666;">(${item.type})</span>`;
        html += `<div style="color:#888; font-size:11px; margin-left:12px; white-space:nowrap; overflow:hidden; text-overflow:ellipsis;">${escapeHtml(item.preview)}</div>`;
        html += '</div>';
      });
      
      html += '</div>';
      explorer.innerHTML = html;
    }

    function searchWindow() {
      const query = document.getElementById('searchKey').value.toLowerCase();
      if (!query) {
        alert('ê²€ìƒ‰ì–´ë¥¼ ì…ë ¥í•˜ì„¸ìš”');
        return;
      }
      
      const explorer = document.getElementById('explorer');
      let results = [];
      
      function searchObj(obj, path, depth = 0) {
        if (depth > 3) return;
        if (!obj || typeof obj !== 'object') return;
        
        try {
          const keys = Object.keys(obj);
          keys.forEach(key => {
            const fullPath = path ? `${path}.${key}` : key;
            if (key.toLowerCase().includes(query)) {
              try {
                const value = obj[key];
                const type = typeof value;
                let preview = safeStringify(value, 0, 1);
                if (preview.length > 100) preview = preview.slice(0, 100) + '...';
                results.push({ path: fullPath, type, preview });
              } catch(e) {
                results.push({ path: fullPath, type: 'error', preview: e.message });
              }
            }
            
            if (depth < 2) {
              try {
                const value = obj[key];
                if (value && typeof value === 'object' && !Array.isArray(value)) {
                  searchObj(value, fullPath, depth + 1);
                }
              } catch(e) {}
            }
          });
        } catch(e) {}
      }
      
      searchObj(window, 'window', 0);
      
      let html = `<div class="label" style="margin-bottom:8px;">"${query}" ê²€ìƒ‰ ê²°ê³¼: ${results.length}ê°œ</div>`;
      
      if (results.length === 0) {
        html += '<div style="color:#888;">ê²°ê³¼ ì—†ìŒ</div>';
      } else {
        html += '<div style="font-family:monospace; font-size:12px;">';
        results.forEach(item => {
          const color = item.type === 'function' ? '#36c5f0' : 
                       item.type === 'object' ? '#2eb67d' : 
                       item.type === 'error' ? '#e01e5a' : '#e8e8e8';
          html += `<div style="padding:4px 0; border-bottom:1px solid #333;">`;
          html += `<span style="color:#ecb22e;">${item.path}</span>`;
          html += ` <span style="color:#666;">(${item.type})</span>`;
          html += `<div style="color:#888; font-size:11px; margin-left:12px;">${escapeHtml(item.preview)}</div>`;
          html += '</div>';
        });
        html += '</div>';
      }
      
      explorer.innerHTML = html;
    }

    function inspectPath() {
      const path = document.getElementById('objectPath').value;
      const resultEl = document.getElementById('inspectResult');
      
      try {
        const value = eval(path);
        let output = `Type: ${typeof value}\n\n`;
        
        if (typeof value === 'object' && value !== null) {
          output += `Keys (${Object.keys(value).length}):\n`;
          Object.getOwnPropertyNames(value).forEach(key => {
            try {
              const v = value[key];
              const type = typeof v;
              let preview = safeStringify(v, 0, 2);
              if (preview.length > 200) preview = preview.slice(0, 200) + '...';
              output += `  ${key} (${type}): ${preview}\n`;
            } catch(e) {
              output += `  ${key}: [error: ${e.message}]\n`;
            }
          });
        } else {
          output += `Value: ${safeStringify(value, 0, 3)}`;
        }
        
        resultEl.textContent = output;
      } catch(e) {
        resultEl.textContent = 'Error: ' + e.message;
      }
    }

    function clearExplorer() {
      document.getElementById('explorer').innerHTML = '';
      document.getElementById('inspectResult').textContent = '';
    }

    function copyAllResults() {
      const allData = {
        userAgent: navigator.userAgent,
        platform: navigator.platform,
        screen: `${screen.width}x${screen.height}`,
        viewport: `${window.innerWidth}x${window.innerHeight}`,
        devicePixelRatio: window.devicePixelRatio,
        slackCheck: slackResult,
        bridges: bridgeResult,
        customProps: customProps.map(p => ({ key: p.key, type: p.type })),
        allWindowKeys: Object.keys(window).sort(),
        explorerData: allWindowData
      };
      
      const text = JSON.stringify(allData, null, 2);
      
      if (navigator.clipboard) {
        navigator.clipboard.writeText(text).then(() => {
          alert('ì „ì²´ ê²°ê³¼ ë³µì‚¬ë¨!');
        }).catch(() => {
          downloadAsFile(text, 'slack-debug-results.json');
        });
      } else {
        downloadAsFile(text, 'slack-debug-results.json');
      }
    }

    function downloadAsFile(content, filename) {
      const blob = new Blob([content], { type: 'application/json' });
      const url = URL.createObjectURL(blob);
      const a = document.createElement('a');
      a.href = url;
      a.download = filename;
      a.click();
      URL.revokeObjectURL(url);
    }

    // ì»¤ìŠ¤í…€ ì½”ë“œ ì‹¤í–‰
    function runCustomCode() {
      const code = document.getElementById('customCode').value;
      try {
        const result = eval(code);
        document.getElementById('customResult').textContent = 
          typeof result === 'object' ? JSON.stringify(result, null, 2) : String(result);
      } catch(e) {
        document.getElementById('customResult').textContent = 'Error: ' + e.message;
      }
    }

    // ê²°ê³¼ ë³µì‚¬
    function copyResults() {
      const results = {
        userAgent: navigator.userAgent,
        platform: navigator.platform,
        screen: `${screen.width}x${screen.height}`,
        viewport: `${window.innerWidth}x${window.innerHeight}`,
        customWindowProps: customProps.map(p => p.key),
        slackObjects: slackResult,
        bridges: bridgeResult
      };
      
      const text = JSON.stringify(results, null, 2);
      
      if (navigator.clipboard) {
        navigator.clipboard.writeText(text).then(() => {
          alert('ë³µì‚¬ë¨!');
        }).catch(() => {
          prompt('ë³µì‚¬í•˜ì„¸ìš”:', text);
        });
      } else {
        prompt('ë³µì‚¬í•˜ì„¸ìš”:', text);
      }
    }
  </script>
</body>
</html>
